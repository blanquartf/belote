<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Meltdown backend</title>
		<link rel="stylesheet" href="/styles.css" />
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
		<script src="index_backend.js"></script>
	</head>

	<body ng-app="meltdownAdmin" ng-controller="AdminCtrl as vm">
		<div class="button_container_admin">
			<h1 ng-show="vm.timer>0" style="margin: 40px auto">Tirage automatique des tables dans {{vm.getTimerRendering(vm.timer)}}</h1>
		</div>
		<div class="button_container_admin">
			<button class="secondary_background" type="button" ng-click="vm.clearTables()">Vider tables</button>
			<button class="secondary_background" type="button" ng-click="vm.generateTables()">Distribuer Tables</button>
			<button class="secondary_background" type="button" ng-click="vm.reshuffleTables()">Re-MÃ©langer Tables</button>
			<button class="secondary_background" type="button" ng-click="vm.notifyAll()">Notifier tout le monde</button>

		</div>
		<div class="button_container_admin">
			<button class="secondary_background" type="button" ng-click="vm.launchTimer(5)">Lancer timer 5 min</button>
			<button class="secondary_background" type="button" ng-click="vm.launchTimer(10)">Lancer timer 10 min</button>
			<button class="secondary_background" type="button" ng-click="vm.launchTimer(15)">Lancer timer 15 min</button>
			<button class="secondary_background" type="button" ng-click="vm.removeTimer()">Supprimer timer</button>
		</div>
		<div id="tables" ng-repeat="table in vm.tables">
			<div class="table_ready_status">
				<div class="table_ready_status">{{table.name}} : ({{table.readyCount}} / {{table.users.length}} prÃªts)</div>
				<button ng-click="vm.changeReadyState(table.id, true)">PrÃªt</button>
				<button ng-click="vm.changeReadyState(table.id, false)">Pas prÃªt</button>
				<button ng-click="vm.tableDelete(table.id)" ng-if="!table.panama">Supprimer table</button>
			</div>
			<table class="tables">
				<thead>
					<tr>
						<th>Joueur</th>
						<th ng-if="!table.panama">Equipe</th>
						<th>Tarot</th>
						<th>Deux tables</th>
						<th>PrÃªt</th>
						<th ng-if="!table.panama">Fini</th>
						<th ng-if="table.panama">Supprimer</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="user in table.users">
						<td ng-style="{'color': user.ready ? '#006400' : '#FF8C00'}">{{user.pseudo}}</td>
						<td ng-if="!table.panama"><span ng-style="{ color: user.team }" style="margin-right: 3px">{{user.team}}</span></td>
						<td ng-if="!user.canPlayTarot" ng-click="vm.canPlayTarot(user.pseudo, true)" style="cursor: pointer">âŒ</td>
						<td ng-if="user.canPlayTarot" ng-click="vm.canPlayTarot(user.pseudo, false)" style="cursor: pointer">âœ…</td>
						<td ng-if="!user.canPlayTwoTables" ng-click="vm.canPlayTwoTables(user.pseudo, true)" style="cursor: pointer">âŒ</td>
						<td ng-if="user.canPlayTwoTables" ng-click="vm.canPlayTwoTables(user.pseudo, false)" style="cursor: pointer">âœ…</td>
						<td ng-if="!user.ready" ng-click="vm.ready(user.pseudo, true)" style="cursor: pointer">âŒ</td>
						<td ng-if="user.ready" ng-click="vm.ready(user.pseudo, false)" style="cursor: pointer">âœ…</td>
						<td ng-if="!table.panama" ng-click="vm.tableFinished(table.id,user.team)" style="cursor: pointer">ğŸ</td>
						<td ng-if="table.panama" ng-click="vm.userDelete(user.pseudo)" style="cursor: pointer">ğŸš®</td>
					</tr>
				</tbody>
			</table>
		</div>
		<a href="/" target="_blank">Frontend</a>
		<a href="/userList" target="_blank">Liste utilisateurs</a>
		<br />
	</body>
</html>
